type: sections
max_columns: 4
title: Powervault MQTT
path: powervault-mqtt
sections:
  - type: grid
    cards:
      - type: heading
        heading: ‚ö° Powervault P3
        heading_style: title
      - type: horizontal-stack
        cards:
          - type: gauge
            entity: sensor.pv3_battery_soc
            name: Battery SoC
            min: 0
            max: 100
            needle: true
            severity:
              green: 60
              yellow: 30
              red: 0
          - type: gauge
            entity: sensor.pv3_battery_soh
            name: State of Health
            min: 0
            max: 100
            needle: true
            severity:
              green: 80
              yellow: 60
              red: 40
          - type: gauge
            entity: sensor.pv3_grid_voltage
            name: Grid Voltage
            min: 210
            max: 260
            needle: true
            severity:
              green: 225
              yellow: 240
              red: 250

  - type: grid
    cards:
      - type: heading
        heading: üîÑ Power Flow
      - type: custom:power-flow-card
        entities:
          battery: sensor.pv3_battery_soc
          battery_charge: sensor.pv3_inverter_charge_power
          grid: sensor.pv3_grid_active_power
          house: sensor.pv3_house_active_power_3
        inverted_entities:
          - battery_charge
        watt_threshold: 50
        kw_decimals: 2
        display_zero_lines: false

  - type: grid
    cards:
      - type: heading
        heading: üîã Battery
      - type: entities
        show_header_toggle: false
        entities:
          - entity: sensor.pv3_battery_soc
            name: State of Charge
          - entity: sensor.p3_battery_voltage
            name: Voltage
          - entity: sensor.p3_battery_current
            name: Current
          - entity: sensor.p3_battery_capacity
            name: Usable Capacity %

  - type: grid
    cards:
      - type: heading
        heading: üíö Battery Health (Pylontech)
      - type: entities
        show_header_toggle: false
        entities:
          - entity: sensor.pv3_battery_soh
            name: State of Health
          - entity: sensor.pv3_battery_soh_min
            name: SOH Min
          - entity: sensor.pv3_battery_cycles_avg
            name: Cycles (Avg)
          - entity: sensor.pv3_battery_cycles_max
            name: Cycles (Max)
          - entity: sensor.pv3_module_voltage_avg
            name: Module Voltage (Avg)
          - entity: sensor.pv3_battery_current_total
            name: Battery Current (Total)

  - type: grid
    cards:
      - type: heading
        heading: üîå Cell Voltages
      - type: entities
        show_header_toggle: false
        entities:
          - entity: sensor.pv3_cell_voltage_max
            name: Cell Voltage Max
          - entity: sensor.pv3_cell_voltage_min
            name: Cell Voltage Min

  - type: grid
    cards:
      - type: heading
        heading: üå°Ô∏è Battery Temperatures
      - type: entities
        show_header_toggle: false
        entities:
          - entity: sensor.pv3_cell_temp_avg
            name: Cell Temp Avg
          - entity: sensor.pv3_cell_temp_max
            name: Cell Temp Max
          - entity: sensor.pv3_cell_temp_min
            name: Cell Temp Min
          - entity: sensor.pv3_bms_temp_avg
            name: BMS Temp Avg

  - type: grid
    cards:
      - type: heading
        heading: üî• Inverter Temperatures
      - type: entities
        show_header_toggle: false
        entities:
          - entity: sensor.pv3_inverter_temp
            name: Inverter Temp
          - entity: sensor.pv3_boost_temp
            name: Boost Temp
          - entity: sensor.pv3_inner_temp
            name: Inner Temp

  - type: grid
    cards:
      - type: heading
        heading: üìä Power Limits
      - type: entities
        show_header_toggle: false
        entities:
          - entity: sensor.pv3_battery_power_rating
            name: Battery Power Rating
          - entity: sensor.pv3_max_charge_power
            name: Max Charge Power
          - entity: sensor.pv3_max_discharge_power
            name: Max Discharge Power
          - type: divider
          - entity: sensor.pv3_safetycheck_max_charge_power_3
            name: SafetyCheck Charge (kW)
          - entity: sensor.pv3_safetycheck_max_discharge_power_3
            name: SafetyCheck Discharge (kW)

  - type: grid
    cards:
      - type: heading
        heading: üîí Battery Limits (Pylontech)
      - type: entities
        show_header_toggle: false
        entities:
          - entity: sensor.pv3_charge_voltage_limit
            name: Charge Voltage Limit
          - entity: sensor.pv3_discharge_voltage_limit
            name: Discharge Voltage Limit
          - entity: sensor.pv3_charge_current_limit
            name: Charge Current Limit
          - entity: sensor.pv3_discharge_current_limit
            name: Discharge Current Limit

  - type: grid
    cards:
      - type: heading
        heading: üìÖ Schedule
      - type: entities
        show_header_toggle: false
        entities:
          - entity: sensor.pv3_schedule_event
            name: Schedule Event
          - entity: sensor.pv3_schedule_setpoint
            name: Schedule Setpoint (W)

  - type: grid
    cards:
      - type: heading
        heading: ‚ö° Grid & EPS
      - type: entities
        show_header_toggle: false
        entities:
          - entity: sensor.pv3_grid_active_power
            name: Inverter Grid CT
          - entity: sensor.pv3_grid_voltage
            name: Grid Voltage
          - entity: sensor.pv3_grid_frequency
            name: Grid Frequency
          - entity: sensor.pv3_eps_grid_loss
            name: EPS Grid Loss (0=OK)

  - type: grid
    cards:
      - type: heading
        heading: üì° Inverter Measurements
      - type: entities
        show_header_toggle: false
        entities:
          - entity: sensor.pv3_local_active_power_3
            name: Inverter AC Output
          - entity: sensor.pv3_house_active_power_3
            name: PV Internal CT
          - entity: sensor.pv3_inverter_charge_power
            name: Battery Charge Rate

  - type: grid
    cards:
      - type: heading
        heading: üîå AUX1 External CT
      - type: entities
        show_header_toggle: false
        entities:
          - entity: sensor.pv3_aux1_current_2
            name: AUX1 CT Current
          - entity: sensor.pv3_aux1_apparent_power_2
            name: AUX1 CT Power

  - type: grid
    cards:
      - type: heading
        heading: ‚ö†Ô∏è Alarms & Status
      - type: entities
        show_header_toggle: false
        entities:
          - entity: sensor.pv3_alarm_count
            name: Active Alarms
          - entity: sensor.pv3_alarm_list
            name: Alarm List

  - type: grid
    cards:
      - type: heading
        heading: üìà SoC & Health History
      - type: history-graph
        hours_to_show: 24
        entities:
          - entity: sensor.pv3_battery_soc
            name: SoC
          - entity: sensor.pv3_battery_soh
            name: SOH

  - type: grid
    cards:
      - type: heading
        heading: üìà Power History
      - type: history-graph
        hours_to_show: 24
        entities:
          - entity: sensor.pv3_local_active_power_3
            name: Inverter AC Output
          - entity: sensor.pv3_inverter_charge_power
            name: Battery Charge Rate
          - entity: sensor.pv3_grid_active_power
            name: Inverter Grid CT

  - type: grid
    cards:
      - type: heading
        heading: üìà Cell Voltage History
      - type: history-graph
        hours_to_show: 24
        entities:
          - entity: sensor.pv3_cell_voltage_max
            name: Max Cell
          - entity: sensor.pv3_cell_voltage_min
            name: Min Cell

  - type: grid
    cards:
      - type: heading
        heading: üìà Temperature History
      - type: history-graph
        hours_to_show: 24
        entities:
          - entity: sensor.pv3_cell_temp_avg
            name: Cell Temp
          - entity: sensor.pv3_inverter_temp
            name: Inverter Temp
          - entity: sensor.pv3_bms_temp_avg
            name: BMS Temp

cards: []
